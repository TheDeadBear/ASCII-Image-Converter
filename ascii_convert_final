from ascii_magic import AsciiArt
import sys
from pathlib import Path

# USER CONFIGURATION
DEFAULT_COLUMNS = 120
DEFAULT_CHAR = None  # None lets the library pick the default charset
DEFAULT_MONOCHROME = True

def main():
    if len(sys.argv) < 2:
        print("Usage: python ascii_convert_final.py <image_path>")
        sys.exit(1)

    image_path = Path(sys.argv[1])

    if not image_path.exists():
        print(f"File not found: {image_path}")
        sys.exit(1)

    # STEP 1 — create an AsciiArt object from the image
    art = AsciiArt.from_image(str(image_path))

    # STEP 2 — print ASCII art to the terminal
    art.to_terminal(
        columns=DEFAULT_COLUMNS,
        char=DEFAULT_CHAR,
        monochrome=DEFAULT_MONOCHROME
    )

    # STEP 3 — save ASCII art to a text file
    output_path = image_path.with_suffix(".txt")
    ascii_string = art.to_ascii(
        columns=DEFAULT_COLUMNS,
        char=DEFAULT_CHAR,
        monochrome=DEFAULT_MONOCHROME
    )

    with open(output_path, "w", encoding="utf-8") as f:
        f.write(ascii_string)

    print(f"\nASCII saved to: {output_path}")

if __name__ == "__main__":
    main()
